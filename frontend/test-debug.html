<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Test Page</title>
    <link rel="stylesheet" href="style.css">
    <script src="config.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>Debug Test Page</h1>
        </header>
        
        <main>
            <div class="debate-container">
                <!-- Timer Section -->
                <div class="timer-section">
                    <div id="timerContainer" class="timer-container">
                        <div id="timerLabel" class="timer-label">Preparation Time</div>
                        <div id="timerDisplay" class="timer-display">00:00</div>
                        <div id="timerProgress" class="timer-progress">
                            <div id="timerBar" class="timer-bar"></div>
                        </div>
                    </div>
                </div>
                
                <!-- Side Assignment -->
                <div class="side-section">
                    <h3>Debate Positions</h3>
                    <div class="sides-container">
                        <div class="side-info">
                            <span class="side-label">Your Side:</span>
                            <span id="yourSide" class="side-value">Not Assigned</span>
                        </div>
                        <div class="side-info">
                            <span class="side-label">Opponent Side:</span>
                            <span id="opponentSide" class="side-value">Not Assigned</span>
                        </div>
                    </div>
                    
                    <!-- Test buttons -->
                    <div style="margin-top: 20px;">
                        <button id="testPositionsButton" class="primary-button">Test Positions</button>
                        <button id="testTimerButton" class="success-button">Test Timer</button>
                        <button id="testBothButton" class="secondary-button">Test Both</button>
                    </div>
                    
                    <div id="debugOutput" style="margin-top: 10px; padding: 10px; background: #f0f0f0; border-radius: 4px; font-family: monospace; font-size: 12px; white-space: pre-wrap;"></div>
                </div>
            </div>
        </main>
    </div>
    
    <script src="script.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const debugOutput = document.getElementById('debugOutput');
            
            function log(message) {
                console.log(message);
                if (debugOutput) {
                    debugOutput.textContent += new Date().toLocaleTimeString() + ': ' + message + '\n';
                }
            }
            
            // Test positions button
            document.getElementById('testPositionsButton').addEventListener('click', () => {
                log('Testing position assignment...');
                try {
                    handleDebateStarted({
                        your_side: 'Proposition',
                        opponent_side: 'Negation'
                    });
                    log('Position assignment completed successfully');
                } catch (error) {
                    log('Error in position assignment: ' + error.message);
                }
            });
            
            // Test timer button
            document.getElementById('testTimerButton').addEventListener('click', () => {
                log('Testing timer functionality...');
                try {
                    // Start preparation timer
                    handlePrepTimer({
                        type: 'prep_timer_start'
                    });
                    
                    // Simulate countdown
                    let timeLeft = 10; // Short test - 10 seconds
                    const countdownInterval = setInterval(() => {
                        timeLeft--;
                        const minutes = Math.floor(timeLeft / 60);
                        const seconds = timeLeft % 60;
                        
                        handlePrepTimer({
                            display: minutes.toString().padStart(2, '0') + ':' + seconds.toString().padStart(2, '0'),
                            remaining_seconds: timeLeft
                        });
                        
                        if (timeLeft <= 0) {
                            clearInterval(countdownInterval);
                            log('Timer test completed');
                        }
                    }, 1000);
                    
                    log('Timer test started (10 second countdown)');
                } catch (error) {
                    log('Error in timer test: ' + error.message);
                }
            });
            
            // Test both button
            document.getElementById('testBothButton').addEventListener('click', () => {
                log('Testing both positions and timer...');
                
                // Test positions first
                document.getElementById('testPositionsButton').click();
                
                // Then test timer after a short delay
                setTimeout(() => {
                    document.getElementById('testTimerButton').click();
                }, 1000);
            });
            
            log('Debug test page loaded');
        });
    </script>
</body>
</html>
